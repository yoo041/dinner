import React, { useState } from 'react';
import { UtensilsCrossed, ChefHat, Flame, Clock, Users, RefreshCw } from 'lucide-react';

export default function DinnerRecommender() {
  const [birthYear, setBirthYear] = useState('');
  const [recommendation, setRecommendation] = useState(null);

  const menuDatabase = [
    { name: 'ê¹€ì¹˜ì°Œê°œ', category: 'í•œì‹', spicy: 3, time: 30, people: 2 },
    { name: 'ëœì¥ì°Œê°œ', category: 'í•œì‹', spicy: 1, time: 25, people: 2 },
    { name: 'ì‚¼ê²¹ì‚´', category: 'í•œì‹', spicy: 1, time: 20, people: 3 },
    { name: 'ë¶ˆê³ ê¸°', category: 'í•œì‹', spicy: 1, time: 40, people: 3 },
    { name: 'ë¹„ë¹”ë°¥', category: 'í•œì‹', spicy: 2, time: 15, people: 1 },
    { name: 'ê°ˆë¹„íƒ•', category: 'í•œì‹', spicy: 1, time: 120, people: 2 },
    { name: 'ìˆœë‘ë¶€ì°Œê°œ', category: 'í•œì‹', spicy: 3, time: 20, people: 2 },
    { name: 'ì œìœ¡ë³¶ìŒ', category: 'í•œì‹', spicy: 4, time: 25, people: 2 },
    { name: 'ë–¡ë³¶ì´', category: 'ë¶„ì‹', spicy: 4, time: 15, people: 2 },
    { name: 'ê¹€ë°¥', category: 'ë¶„ì‹', spicy: 0, time: 30, people: 2 },
    { name: 'ë¼ë©´', category: 'ë¶„ì‹', spicy: 2, time: 10, people: 1 },
    { name: 'ìš°ë™', category: 'ì¼ì‹', spicy: 0, time: 15, people: 1 },
    { name: 'ëˆì¹´ì¸ ', category: 'ì¼ì‹', spicy: 0, time: 30, people: 1 },
    { name: 'ì´ˆë°¥', category: 'ì¼ì‹', spicy: 0, time: 40, people: 2 },
    { name: 'ê·œë™', category: 'ì¼ì‹', spicy: 0, time: 20, people: 1 },
    { name: 'ì§œì¥ë©´', category: 'ì¤‘ì‹', spicy: 0, time: 20, people: 1 },
    { name: 'ì§¬ë½•', category: 'ì¤‘ì‹', spicy: 3, time: 25, people: 1 },
    { name: 'íƒ•ìˆ˜ìœ¡', category: 'ì¤‘ì‹', spicy: 0, time: 35, people: 3 },
    { name: 'ë§ˆë¼íƒ•', category: 'ì¤‘ì‹', spicy: 5, time: 15, people: 1 },
    { name: 'íŒŒìŠ¤íƒ€', category: 'ì–‘ì‹', spicy: 1, time: 30, people: 1 },
    { name: 'ìŠ¤í…Œì´í¬', category: 'ì–‘ì‹', spicy: 0, time: 40, people: 2 },
    { name: 'í”¼ì', category: 'ì–‘ì‹', spicy: 0, time: 25, people: 3 },
    { name: 'ë¦¬ì¡°ë˜', category: 'ì–‘ì‹', spicy: 0, time: 35, people: 2 },
    { name: 'í–„ë²„ê±°', category: 'ì–‘ì‹', spicy: 0, time: 15, people: 1 },
    { name: 'ìƒëŸ¬ë“œ', category: 'ì–‘ì‹', spicy: 0, time: 10, people: 1 },
    { name: 'ì¹˜í‚¨', category: 'í•œì‹', spicy: 2, time: 30, people: 3 },
    { name: 'ìŒˆë°¥', category: 'í•œì‹', spicy: 1, time: 25, people: 2 },
    { name: 'ì¹¼êµ­ìˆ˜', category: 'í•œì‹', spicy: 1, time: 20, people: 2 },
    { name: 'ëƒ‰ë©´', category: 'í•œì‹', spicy: 2, time: 15, people: 1 },
    { name: 'ì‚¼ê³„íƒ•', category: 'í•œì‹', spicy: 0, time: 90, people: 1 }
  ];

  const reasons = [
    'ì˜¤ëŠ˜ì€ ì´ ë©”ë‰´ê°€ ë”±ì´ì—ìš”!',
    'ê¸°ë¶„ ì „í™˜í•˜ê¸° ì¢‹ì€ ë©”ë‰´ì…ë‹ˆë‹¤.',
    'ì—ë„ˆì§€ ì¶©ì „ì´ í•„ìš”í•œ ë‚ ì´ë„¤ìš”.',
    'íŠ¹ë³„í•œ í•˜ë£¨ë¥¼ ë§Œë“¤ì–´ì¤„ ë©”ë‰´ì˜ˆìš”.',
    'ë§›ìˆëŠ” ì €ë…ìœ¼ë¡œ í•˜ë£¨ë¥¼ ë§ˆë¬´ë¦¬í•˜ì„¸ìš”.',
    'ì˜¤ëŠ˜ë”°ë¼ ìƒê°ë‚˜ëŠ” ë©”ë‰´ë„¤ìš”.',
    'ê±´ê°•ê³¼ ë§›ì„ ë™ì‹œì— ì¡ì„ ìˆ˜ ìˆì–´ìš”.',
    'í–‰ë³µí•œ ì‹ì‚¬ ì‹œê°„ì„ ì•½ì†í•©ë‹ˆë‹¤.',
    'ê¸°ë¶„ ì¢‹ì€ ì €ë…ì„ ìœ„í•œ ì„ íƒì´ì—ìš”.',
    'ì˜¤ëŠ˜ì˜ ë² ìŠ¤íŠ¸ ì´ˆì´ìŠ¤ì…ë‹ˆë‹¤!'
  ];

  const tips = [
    'ì‹ ì„ í•œ ì¬ë£Œë¥¼ ì‚¬ìš©í•˜ë©´ ë” ë§›ìˆì–´ìš”.',
    'ê°€ì¡±ê³¼ í•¨ê»˜ ë¨¹ìœ¼ë©´ ë” í–‰ë³µí•´ì§‘ë‹ˆë‹¤.',
    'ì²œì²œíˆ ìŒë¯¸í•˜ë©° ë“œì„¸ìš”.',
    'ì¢‹ì€ ìŒì•…ê³¼ í•¨ê»˜í•˜ë©´ ê¸ˆìƒì²¨í™”!',
    'ë§›ìˆê²Œ ë“œì‹œê³  ì¢‹ì€ í•˜ë£¨ ë˜ì„¸ìš”.',
    'ë°°ë‹¬ë„ ì¢‹ì§€ë§Œ ì§ì ‘ ë§Œë“¤ì–´ë³´ëŠ” ê²ƒë„ ì¶”ì²œí•´ìš”.',
    'ì ë‹¹í•œ ì–‘ì„ ë“œì‹œëŠ” ê²ƒì´ ì¢‹ì•„ìš”.',
    'ì‹ì‚¬ í›„ ê°€ë²¼ìš´ ì‚°ì±…ì„ ì¶”ì²œë“œë ¤ìš”.',
    'ì •ì„±ìŠ¤ëŸ½ê²Œ ì¤€ë¹„í•˜ë©´ ë” ë§›ìˆë‹µë‹ˆë‹¤.',
    'ì¢‹ì€ ì‚¬ëŒë“¤ê³¼ í•¨ê»˜í•˜ë©´ ìµœê³ ì˜ˆìš”!'
  ];

  const generateRecommendation = (year) => {
    const today = new Date();
    const seed = parseInt(year) + today.getDate() + today.getMonth() + today.getFullYear();
    
    const random = (min, max) => {
      const x = Math.sin(seed * (min + max + 1)) * 10000;
      return Math.floor((x - Math.floor(x)) * (max - min + 1)) + min;
    };

    const mainIndex = random(0, menuDatabase.length - 1);
    let sideIndex = random(0, menuDatabase.length - 1);
    while (sideIndex === mainIndex) {
      sideIndex = random(0, menuDatabase.length - 1);
    }

    const mainMenu = menuDatabase[mainIndex];
    const sideMenu = menuDatabase[sideIndex];
    const reason = reasons[random(0, reasons.length - 1)];
    const tip = tips[random(0, tips.length - 1)];
    const score = random(85, 100);

    return {
      main: mainMenu,
      side: sideMenu,
      reason: reason,
      tip: tip,
      score: score
    };
  };

  const handleSubmit = (e) => {
    if (e) e.preventDefault();
    if (birthYear && birthYear >= 1900 && birthYear <= 2024) {
      setRecommendation(generateRecommendation(birthYear));
    } else {
      alert('ì˜¬ë°”ë¥¸ ì¶œìƒë…„ë„ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš” (1900-2024)');
    }
  };

  const renderSpicyLevel = (level) => {
    return [...Array(5)].map((_, i) => (
      <Flame
        key={i}
        size={16}
        className={i < level ? 'fill-red-500 text-red-500' : 'text-gray-300'}
      />
    ));
  };

  const today = new Date().toLocaleDateString('ko-KR', {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
    weekday: 'long'
  });

  return (
    <div className="min-h-screen bg-gradient-to-br from-orange-400 via-red-300 to-pink-300 p-4 md:p-8">
      <div className="max-w-2xl mx-auto">
        <div className="bg-white rounded-3xl shadow-2xl p-8 mb-6">
          <div className="text-center mb-8">
            <div className="flex justify-center mb-4">
              <UtensilsCrossed className="text-orange-500" size={48} />
            </div>
            <h1 className="text-4xl font-bold text-gray-800 mb-2">ì˜¤ëŠ˜ì˜ ì €ë… ë©”ë‰´</h1>
            <p className="text-gray-600">{today}</p>
          </div>

          {!recommendation ? (
            <div className="space-y-6">
              <div>
                <label className="block text-lg font-semibold text-gray-700 mb-3">
                  ì¶œìƒë…„ë„ë¥¼ ì…ë ¥í•˜ì„¸ìš”
                </label>
                <input
                  type="number"
                  value={birthYear}
                  onChange={(e) => setBirthYear(e.target.value)}
                  placeholder="ì˜ˆ: 1990"
                  className="w-full px-6 py-4 text-lg border-2 border-orange-200 rounded-xl focus:outline-none focus:border-orange-400 transition"
                  min="1900"
                  max="2024"
                  onKeyDown={(e) => {
                    if (e.key === 'Enter') {
                      handleSubmit(e);
                    }
                  }}
                />
              </div>
              <button
                onClick={handleSubmit}
                className="w-full bg-gradient-to-r from-orange-500 to-red-500 text-white font-bold py-4 px-6 rounded-xl hover:from-orange-600 hover:to-red-600 transform hover:scale-105 transition duration-200 shadow-lg"
              >
                ë©”ë‰´ ì¶”ì²œë°›ê¸°
              </button>
            </div>
          ) : (
            <div className="space-y-6">
              <div className="bg-gradient-to-r from-orange-100 to-red-100 rounded-xl p-6">
                <div className="flex items-center justify-between mb-3">
                  <h2 className="text-xl font-bold text-orange-800 flex items-center gap-2">
                    <ChefHat size={24} />
                    ì˜¤ëŠ˜ì˜ ë©”ì¸ ë©”ë‰´
                  </h2>
                  <div className="bg-orange-500 text-white px-3 py-1 rounded-full text-sm font-bold">
                    {recommendation.score}ì 
                  </div>
                </div>
                <div className="bg-white rounded-lg p-4 mb-3">
                  <h3 className="text-3xl font-bold text-gray-800 mb-2">{recommendation.main.name}</h3>
                  <div className="flex flex-wrap gap-2">
                    <span className="bg-orange-100 text-orange-700 px-3 py-1 rounded-full text-sm font-semibold">
                      {recommendation.main.category}
                    </span>
                  </div>
                </div>
                <p className="text-gray-700 leading-relaxed">{recommendation.reason}</p>
              </div>

              <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div className="bg-red-50 rounded-xl p-5">
                  <h3 className="font-bold text-red-700 mb-2 flex items-center gap-2">
                    <Flame size={20} />
                    ë§¤ìš´ ì •ë„
                  </h3>
                  <div className="flex gap-1 mb-2">
                    {renderSpicyLevel(recommendation.main.spicy)}
                  </div>
                  <p className="text-xs text-gray-600">
                    {recommendation.main.spicy === 0 ? 'ì•ˆ ë§¤ì›Œìš”' : 
                     recommendation.main.spicy <= 2 ? 'ì‚´ì§ ë§¤ì›Œìš”' :
                     recommendation.main.spicy <= 3 ? 'ì¤‘ê°„ ë§¤ì›Œìš”' : 'ë§ì´ ë§¤ì›Œìš”'}
                  </p>
                </div>

                <div className="bg-blue-50 rounded-xl p-5">
                  <h3 className="font-bold text-blue-700 mb-2 flex items-center gap-2">
                    <Clock size={20} />
                    ì¡°ë¦¬ ì‹œê°„
                  </h3>
                  <p className="text-2xl font-bold text-blue-700">{recommendation.main.time}ë¶„</p>
                  <p className="text-xs text-gray-600 mt-1">ì˜ˆìƒ ì†Œìš” ì‹œê°„</p>
                </div>

                <div className="bg-green-50 rounded-xl p-5">
                  <h3 className="font-bold text-green-700 mb-2 flex items-center gap-2">
                    <Users size={20} />
                    ê¶Œì¥ ì¸ì›
                  </h3>
                  <p className="text-2xl font-bold text-green-700">{recommendation.main.people}ì¸ë¶„</p>
                  <p className="text-xs text-gray-600 mt-1">ì¶”ì²œ ì¸ì›</p>
                </div>
              </div>

              <div className="bg-yellow-50 rounded-xl p-5">
                <h3 className="font-bold text-yellow-800 mb-2 flex items-center gap-2">
                  <UtensilsCrossed size={20} />
                  ì‚¬ì´ë“œ ë©”ë‰´ ì¶”ì²œ
                </h3>
                <div className="bg-white rounded-lg p-3">
                  <p className="text-xl font-bold text-gray-800">{recommendation.side.name}</p>
                  <p className="text-sm text-gray-600 mt-1">{recommendation.side.category}</p>
                </div>
              </div>

              <div className="bg-gradient-to-r from-purple-100 to-pink-100 rounded-xl p-5">
                <h3 className="font-bold text-purple-800 mb-2">ğŸ’¡ ì˜¤ëŠ˜ì˜ íŒ</h3>
                <p className="text-gray-700">{recommendation.tip}</p>
              </div>

              <button
                onClick={() => {
                  setRecommendation(null);
                  setBirthYear('');
                }}
                className="w-full bg-gray-200 text-gray-700 font-semibold py-3 px-6 rounded-xl hover:bg-gray-300 transition duration-200 flex items-center justify-center gap-2"
              >
                <RefreshCw size={20} />
                ë‹¤ì‹œ ì¶”ì²œë°›ê¸°
              </button>
            </div>
          )}
        </div>

        <p className="text-center text-white text-sm opacity-80">
          ğŸ½ï¸ ë§›ìˆëŠ” ì €ë… ë˜ì„¸ìš”! ğŸ½ï¸
        </p>
      </div>
    </div>
  );
}